# Setup MOTD

- name: Clear /etc/motd
  when: 'linux_banner_motd_state == "empty"'
  copy:
    content: ''
    dest: '/etc/motd'
    mode: '0644'

- name: Set /etc/motd
  when: 'linux_banner_motd_state == "motd" and linux_banner_motd_path is defined'
  copy:
    src: '{{ linux_banner_motd_path }}'
    dest: '/etc/motd'
    mode: '0644'

- name: Clear /etc/issue
  when: 'linux_banner_issue_state == "empty"'
  copy:
    content: ''
    dest: '/etc/issue'
    mode: '0644'

- name: Clear /etc/issue.net
  when: 'linux_banner_issue_net_state == "empty"'
  copy:
    content: ''
    dest: '/etc/issue.net'
    mode: '0644'

- name: Setting /etc/issue to logo
  when: 'linux_banner_issue_state == "logo" and linux_ascii_logo_path is defined'
  copy:
    src: '{{ linux_ascii_logo_path }}'
    dest: '/etc/issue'
    mode: '0644'

- name: Setting /etc/issue.net to logo
  when: 'linux_banner_issue_state == "logo" and linux_ascii_logo_path is defined'
  copy:
    src: '{{ linux_ascii_logo_path }}'
    dest: '/etc/issue.net'
    mode: '0644'

- name: Install packages for DMOTD (Debian -12)
  when: 'linux_banner_dmotd_enable and ansible_distribution_major_version <= "12"'
  apt:
    name:
      - neofetch
      - lolcat

- name: Install packages for DMOTD (Debian 13-)
  when: 'linux_banner_dmotd_enable and ansible_distribution_major_version >= "13"'
  apt:
    name:
      - fastfetch
      - lolcat

- name: Add logo for DMOTD
  when: 'linux_banner_dmotd_enable and linux_ascii_logo_path is defined'
  copy:
    src: '{{ linux_ascii_logo_path }}'
    dest: '/etc/logo'
    mode: '0644'

- name: Add DMOTD script (Debian -12)
  when: 'linux_banner_dmotd_enable and ansible_distribution_major_version <= "12"'
  copy:
    src: 'dmotd.v1.sh'
    dest: '/etc/profile.d/dmotd.sh'
    mode: '0644'

- name: Add DMOTD script (Debian 13-)
  when: 'linux_banner_dmotd_enable and ansible_distribution_major_version >= "13"'
  copy:
    src: 'dmotd.sh'
    dest: '/etc/profile.d/dmotd.sh'
    mode: '0644'

- name: Remove DMOTD script
  when: 'not linux_banner_dmotd_enable'
  file:
    path: '/etc/profile.d/dmotd.sh'
    state: absent
